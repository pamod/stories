(this.webpackChunk_wso2apim_devportal=this.webpackChunk_wso2apim_devportal||[]).push([[9068],{261248:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>G});var n=s(811504),i=s(906940),a=s(404292),r=s(715656),o=s(162248),c=s(203268),d=s.n(c),l=s(226120),p=s(669872),u=s(924004),h=s(902706),m=s(135912),y=s(835444),g=s(932144),S=s.n(g),A=s(876324),b=s.n(A),v=s(727200),f=s.n(v),T=s(40172),E=s(969072),P=s(380496),k=s(883660),w=s(219811),I=s.n(w),K=s(33964),C=s(47568),O=s(403972),x=s(273384),R=(s(928060),s(975920)),N=s(495240),H=s(96144),U=s(721368);function D(e){const{BaseLayout:t,oldProps:s,spec:i}=e,o=(0,n.useMemo)((()=>function(e,t){const s=t.reduce(((e,t)=>e[t]),e);return s["x-auth-type"]&&"none"!==s["x-auth-type"].toLowerCase()}(i,s.specPath)),[]);return n.createElement("div",null,n.createElement(r.cp,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center"},n.createElement(r.cp,{item:!0,md:11},n.createElement(t,s)),n.createElement(r.cp,{item:!0,justifyContent:"flex-end",alignItems:"right"},n.createElement(E.c,{title:o?n.createElement(a.c,{id:"Apis.Details.Resources.components.Operation.disable.security.when.used.in.api.products",defaultMessage:"Security enabled"}):n.createElement(a.c,{id:"Apis.Details.Resources.components.enabled.security",defaultMessage:"No security"}),"aria-label":n.createElement(a.c,{id:"Apis.Details.Resources.components.Operation.security.operation",defaultMessage:"Security "})},n.createElement(H.c,{"aria-label":"Security",size:"large"},o?n.createElement(N.c,{fontSize:"small"}):n.createElement(U.c,{fontSize:"small"}))))))}const M=n.memo(D),j=function(e){return{wrapComponents:{info:()=>()=>null,authorizeBtn:()=>()=>null,authorizeOperationBtn:()=>()=>null,OperationSummary:t=>s=>n.createElement(M,{BaseLayout:t,oldProps:s,spec:e})}}},z=e=>{const{spec:t,accessTokenProvider:s,authorizationHeader:i,api:a}=e,r=(0,n.useRef)(e.securitySchemeType),o=(0,n.useRef)(e.authorizationHeader);(0,n.useEffect)((()=>{r.current=e.securitySchemeType}),[e.securitySchemeType]),(0,n.useEffect)((()=>{o.current=e.authorizationHeader}),[e.authorizationHeader]);const c={spec:t,validatorUrl:null,defaultModelsExpandDepth:-1,docExpansion:"list",requestInterceptor:e=>{const{url:t}=e,{context:n}=a,c=r.current,d=o.current,l=`${n}/*`;if("API-KEY"===c?e.headers[d]=s():"BASIC"===c?e.headers[d]="Basic "+s():"TEST"===c||a.advertiseInfo&&a.advertiseInfo.advertised&&""!==i?e.headers[d]=s():e.headers[d]="Bearer "+s(),t.endsWith(l))e.url=t.substring(0,t.length-2);else if(t.includes(l+"?")){const s=t.split("/*?");e.url=s.length>1?s[0]+"?"+s[1]:s[0]}return e},defaultModelExpandDepth:-1,plugins:[j(t)]},[d,l]=(0,n.useState)(),[p,u]=(0,n.useState)();return(0,n.useEffect)((()=>{if(!p)return;const e=document.querySelectorAll(".opblock .authorization__btn");for(let t=0;t<e.length;t++)e[t].remove();document.querySelector(".schemes select").setAttribute("id","schemes"),document.getElementById("unlocked").parentNode.parentNode.remove(),u(!1)}),[p]),(0,n.useEffect)((()=>{u(!0)}),[d]),n.createElement(n.Fragment,null,n.createElement(R.c,c),l)};z.propTypes={accessTokenProvider:d().func.isRequired,authorizationHeader:d().string.isRequired,securitySchemeType:d().string.isRequired,api:d().shape({context:d().string.isRequired}).isRequired,spec:d().string.isRequired};const B=z;var q=s(915176),$=s(695312);function _(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function V(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?_(Object(s),!0).forEach((function(t){L(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function L(e,t,s){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?n:String(n))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const W="ApiConsole",Y={iconify:`${W}-iconify`,buttonIcon:`${W}-buttonIcon`,paper:`${W}-paper`,grid:`${W}-grid`,userNotificationPaper:`${W}-userNotificationPaper`,titleSub:`${W}-titleSub`,swaggerUIPaper:`${W}-swaggerUIPaper`},F=(0,i.cp)("div")((e=>{let{theme:t}=e;return{[`& .${Y.iconify}`]:{marginRight:10,font:24},[`& .${Y.buttonIcon}`]:{marginRight:10},[`& .${Y.paper}`]:{margin:t.spacing(1),padding:t.spacing(1)},[`& .${Y.grid}`]:{marginTop:t.spacing(4),marginBottom:t.spacing(4),paddingRight:t.spacing(2),justifyContent:"center"},[`& .${Y.userNotificationPaper}`]:{padding:t.spacing(2)},[`& .${Y.titleSub}`]:{marginLeft:t.spacing(2),paddingTop:t.spacing(2),paddingBottom:t.spacing(2),color:t.palette.getContrastText(t.palette.background.default)},[`& .${Y.swaggerUIPaper}`]:{backgroundColor:t.custom.apiDetailPages.swaggerUIBackground}}}));class J extends n.Component{constructor(e){super(e),L(this,"onCopy",(()=>{this.setState({urlCopied:!0}),setTimeout((function(){this.setState({urlCopied:!1})}),2e3)})),this.state={securitySchemeType:"OAUTH",username:"",password:"",scopes:[],selectedKeyType:"PRODUCTION",keys:[],productionApiKey:"",sandboxApiKey:"",selectedKeyManager:"Resident Key Manager",urlCopied:!1,accessTokenPart:K.c.getCookieWithoutEnvironment("WSO2_AM_TOKEN_1_Default"),tenant:"",selectedAttribute:null,advAuthHeader:"Authorization",advAuthHeaderValue:"",selectedEndpoint:"PRODUCTION"},this.accessTokenProvider=this.accessTokenProvider.bind(this),this.updateSwagger=this.updateSwagger.bind(this),this.setSecurityScheme=this.setSecurityScheme.bind(this),this.setSelectedEnvironment=this.setSelectedEnvironment.bind(this),this.setProductionAccessToken=this.setProductionAccessToken.bind(this),this.setSandboxAccessToken=this.setSandboxAccessToken.bind(this),this.setUsername=this.setUsername.bind(this),this.setPassword=this.setPassword.bind(this),this.setSelectedKeyType=this.setSelectedKeyType.bind(this),this.setSectedKeyManager=this.setSelectedKeyManager.bind(this),this.setKeys=this.setKeys.bind(this),this.updateAccessToken=this.updateAccessToken.bind(this),this.setProductionApiKey=this.setProductionApiKey.bind(this),this.setSandboxApiKey=this.setSandboxApiKey.bind(this),this.converttopostman=this.convertToPostman.bind(this),this.setAdvAuthHeader=this.setAdvAuthHeader.bind(this),this.setAdvAuthHeaderValue=this.setAdvAuthHeaderValue.bind(this),this.setSelectedEndpoint=this.setSelectedEndpoint.bind(this),this.onCopy=this.onCopy.bind(this)}componentDidMount(){const{api:e}=this.context,t=e.id,s=p.c.getUser();let n,i,a,r;const{app:{customUrl:{tenantDomain:o}}}=I();let c="";if("null"!==o)c=o;else{const{location:e}=window;if(e){const{tenant:t}=k.parse(e.search);t&&(c=t)}}this.setState({tenant:c}),this.apiClient=new x.c;const d=this.apiClient.getAPIById(t);let l=null;d.then((e=>{if(n=e.obj,n.endpointURLs&&(i=n.endpointURLs.map((e=>({name:e.environmentName,displayName:e.environmentDisplayName})))),n.scopes){const e=n.scopes.map((e=>e.key));this.setState({scopes:e})}return i&&i.length>0?(a=i[0].name,l="environmentName",this.apiClient.getSwaggerByAPIIdAndEnvironment(t,a)):(l="",this.apiClient.getSwaggerByAPIId(t))})).then((e=>{r=e.obj;let o="OAUTH";return n.securityScheme.includes("oauth2")||(o=n.securityScheme.includes("api_key")?"API-KEY":"BASIC"),this.setState({api:n,swagger:r,environments:i,productionAccessToken:void 0,sandboxAccessToken:void 0,selectedEnvironment:a,securitySchemeType:o,selectedAttribute:l}),null!=s?this.apiClient.getSubscriptions(t):null})).catch((e=>{const{status:t}=e;404===t&&this.setState({notFound:!0})}))}setSecurityScheme(e){this.setState({securitySchemeType:e})}setSelectedEnvironment(e){this.setState({selectedEnvironment:e})}setProductionAccessToken(e){this.setState({productionAccessToken:e})}setSandboxAccessToken(e){this.setState({sandboxAccessToken:e})}setProductionApiKey(e){this.setState({productionApiKey:e})}setSandboxApiKey(e){this.setState({sandboxApiKey:e})}setUsername(e){this.setState({username:e})}setPassword(e){this.setState({password:e})}setSelectedKeyType(e,t,s){t?this.setState({selectedKeyType:e},this.updateAccessToken(s)):this.setState({selectedKeyType:e})}setSelectedKeyManager(e,t,s){t?this.setState({selectedKeyManager:e},this.updateAccessToken(s)):this.setState({selectedKeyManager:e})}setKeys(e){this.setState({keys:e})}setAdvAuthHeader(e){this.setState({advAuthHeader:e})}setAdvAuthHeaderValue(e){this.setState({advAuthHeaderValue:e})}setSelectedEndpoint(e){this.setState({selectedEndpoint:e})}setServersSpec(e,t){let s;const[n,i]=t.split("://");return"http"===n?s=["http"]:"https"===n&&(s=["https"]),V(V({},e),{},{schemes:s,host:i})}convertToPostman(e){b().convert({type:"string",data:e},{},((t,s)=>{if(s.result)S()(JSON.stringify(s.output[0].data),"postman collection");else{const t=f().convert(e);t?S()(JSON.stringify(t),"postman collection"):console.log("Could not convert")}}))}updateAccessToken(e){const{selectedKeyType:t,selectedKeyManager:s,keys:n}=this.state;let i;n.get(s)&&n.get(s).keyType===t?(({accessToken:i}=n.get(s).token),"PRODUCTION"===t?this.setProductionAccessToken(i):this.setSandboxAccessToken(i)):$.c.get(e).then((e=>e.getKeys(t))).then((e=>{e.get(s)&&e.get(s).keyType===t&&({accessToken:i}=e.get(s).token),"PRODUCTION"===e.get(s).keyType?this.setProductionAccessToken(i):this.setSandboxAccessToken(i),this.setKeys(e)}))}accessTokenProvider(){const{securitySchemeType:e,username:t,password:s,productionAccessToken:n,sandboxAccessToken:i,selectedKeyType:a,productionApiKey:r,sandboxApiKey:o,api:c,advAuthHeaderValue:d}=this.state;return c.advertiseInfo&&c.advertiseInfo.advertised?d:"BASIC"===e?btoa(t+":"+s):"API-KEY"===e?"PRODUCTION"===a?r:o:"PRODUCTION"===a?n:i}updateSwagger(e){const{api:t,environments:s}=this.state;let n;n=e&&s.find((t=>t.name===e))?this.apiClient.getSwaggerByAPIIdAndEnvironment(t.id,e):this.apiClient.getSwaggerByAPIId(t.id),n.then((e=>{this.setState({swagger:e.obj})}))}render(){const{api:e,notFound:t,swagger:s,securitySchemeType:i,selectedEnvironment:c,environments:d,scopes:g,username:S,password:A,productionAccessToken:b,sandboxAccessToken:v,selectedKeyType:f,accessTokenPart:k,sandboxApiKey:w,productionApiKey:I,selectedKeyManager:K,advAuthHeader:C,advAuthHeaderValue:x,selectedEndpoint:R,urlCopied:N,tenant:H,selectedAttribute:U}=this.state,{location:D}=window,M=p.c.getUser(),j=JSON.stringify(V({},s)),z="data:text/json;charset=utf-8, "+encodeURIComponent(j);if(null==e||null==s)return n.createElement(O.c,null);if(t)return"API Not found !";let $=!1,_=e.authorizationHeader?e.authorizationHeader:"Authorization";e&&e.securityScheme&&($=e.securityScheme.includes("api_key"),$&&"API-KEY"===i&&(_=e.apiKeyHeader?e.apiKeyHeader:"ApiKey"));let L=s;return e.advertiseInfo&&e.advertiseInfo.advertised&&(_=C,L=L.openapi?V(V({},s),{},"PRODUCTION"===R?{servers:[{url:e.advertiseInfo.apiExternalProductionEndpoint}]}:{servers:[{url:e.advertiseInfo.apiExternalSandboxEndpoint}]}):"PRODUCTION"===R?this.setServersSpec(L,e.advertiseInfo.apiExternalProductionEndpoint):this.setServersSpec(L,e.advertiseInfo.apiExternalSandboxEndpoint)),n.createElement(F,null,n.createElement(u.c,{className:Y.paper},n.createElement(r.cp,{container:!0,className:Y.grid},!M&&(!e.advertiseInfo||!e.advertiseInfo.advertised)&&n.createElement(r.cp,{item:!0,md:6},n.createElement(u.c,{className:Y.userNotificationPaper},n.createElement(o.c,{variant:"h5",component:"h3"},n.createElement(l.c,null,"info")," ",n.createElement(a.c,{id:"notice",defaultMessage:"Notice"})),n.createElement(o.c,{component:"p"},n.createElement(a.c,{id:"api.console.require.access.token",defaultMessage:"You need an access token to try the API. Please log in and subscribe to the API to generate an access token. If you already have an access token, please provide it below."}))))),n.createElement(r.cp,{container:!0,className:Y.grid},n.createElement(q.c,{setSecurityScheme:this.setSecurityScheme,securitySchemeType:i,setSelectedEnvironment:this.setSelectedEnvironment,selectedEnvironment:c,productionAccessToken:b,setProductionAccessToken:this.setProductionAccessToken,sandboxAccessToken:v,setSandboxAccessToken:this.setSandboxAccessToken,swagger:L,environments:d,scopes:g,setUsername:this.setUsername,setPassword:this.setPassword,username:S,password:A,setSelectedKeyType:this.setSelectedKeyType,selectedKeyType:f,setSelectedKeyManager:this.setSelectedKeyManager,selectedKeyManager:K,updateSwagger:this.updateSwagger,setKeys:this.setKeys,setProductionApiKey:this.setProductionApiKey,setSandboxApiKey:this.setSandboxApiKey,productionApiKey:I,sandboxApiKey:w,setAdvAuthHeader:this.setAdvAuthHeader,setAdvAuthHeaderValue:this.setAdvAuthHeaderValue,advAuthHeader:C,advAuthHeaderValue:x,setSelectedEndpoint:this.setSelectedEndpoint,selectedEndpoint:R,api:this.state.api,URLs:null})),"SOAP"!==e.type&&n.createElement(r.cp,{container:!0},n.createElement(r.cp,{xs:7,item:!0}),n.createElement(r.cp,{xs:2,item:!0},n.createElement(h.c,{size:"small",color:"grey",onClick:()=>this.convertToPostman(j)},n.createElement(y.GW,{icon:m.c,width:30,height:30,className:Y.buttonIcon}),n.createElement(a.c,{id:"Apis.Details.APIConsole.APIConsole.download.postman",defaultMessage:"Postman collection"}))),n.createElement(r.cp,{xs:3,item:!0},n.createElement("a",{href:z,download:"swagger.json"},n.createElement(h.c,{size:"small",color:"grey"},n.createElement(P.c,{className:Y.buttonIcon}),n.createElement(a.c,{id:"Apis.Details.APIConsole.APIConsole.download.swagger",defaultMessage:"Swagger ( /swagger.json )"}))),n.createElement(E.c,{title:N?n.createElement(a.c,{id:"Apis.Details.Swagger.URL.copied",defaultMessage:"Copied"}):n.createElement(a.c,{id:"Apis.Details.Swagger.URL.copy.to.clipboard",defaultMessage:"Copy to clipboard"}),placement:"top"},n.createElement(h.c,{"aria-label":"Copy to clipboard",className:Y.button,color:"grey",onClick:()=>{navigator.clipboard.writeText(D.origin+"/api/am/devportal/v3/apis/"+e.id+"/swagger?accessToken="+k+"&X-WSO2-Tenant-Q="+H+"&"+U+"="+c).then(this.onCopy())}},n.createElement(T.c,{className:Y.buttonIcon})))))),n.createElement(u.c,{className:Y.swaggerUIPaper},n.createElement(B,{api:this.state.api,accessTokenProvider:this.accessTokenProvider,spec:L,authorizationHeader:_,securitySchemeType:i})))}}J.propTypes={classes:d().shape({paper:d().string.isRequired,titleSub:d().string.isRequired,grid:d().string.isRequired,userNotificationPaper:d().string.isRequired,buttonIcon:d().string.isRequired,iconify:d().string.isRequired}).isRequired},J.contextType=C.U;const G=J},548544:()=>{},15756:()=>{},279100:()=>{},267140:()=>{},301712:()=>{},155964:()=>{},74192:()=>{},93656:()=>{},297044:()=>{},487260:()=>{},207028:()=>{},356412:()=>{},888400:()=>{},954952:()=>{},628852:()=>{},923412:()=>{},829216:()=>{},807728:()=>{},156056:()=>{},501964:()=>{},130468:()=>{},941868:()=>{},340360:()=>{},666454:()=>{},921576:()=>{},919768:()=>{},751817:()=>{},348788:()=>{},665572:()=>{},473132:()=>{},106144:()=>{},26720:()=>{}}]);
//# sourceMappingURL=APIConsole.4e9daa5ea115db5cbb73.bundle.js.map