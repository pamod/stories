/*! For license information please see APICreateRoutes.2ae3aa2df0c5dedb4461.bundle.js.LICENSE.txt */
"use strict";(this.webpackChunk_wso2apim_publisher=this.webpackChunk_wso2apim_publisher||[]).push([[879],{89564:(e,t,n)=>{n.r(t),n.d(t,{default:()=>xn});var r=n(96540),a=n(11848),i=n(56347),o=n(8843),l=n(49450),c=n(5556),s=n.n(c),u=n(33551),p=n(99020),d=n(69067),m=n(58065),f=n(38798),y=n(74010),v=n(54625),A=n(84712),g=n(73357),h=n(4686),b=n(21070),E=n(98587),P=n(58168),w=n(34164),S=n(64111),C=n(17437),I=n(92021),x=n(28466),O=n(44675),j=n(3541),T=n(27553),D=n(17245);function M(e){return(0,D.Ay)("MuiLinearProgress",e)}(0,T.A)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var L=n(74848);const k=["className","color","value","valueBuffer","variant"];let W,R,V,N,F,B,G=e=>e;const _=(0,C.keyframes)(W||(W=G`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`)),U=(0,C.keyframes)(R||(R=G`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`)),q=(0,C.keyframes)(V||(V=G`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`)),Q=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress[`${t}Bg`]:"light"===e.palette.mode?(0,I.a)(e.palette[t].main,.62):(0,I.e$)(e.palette[t].main,.5),$=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`color${(0,x.A)(n.color)}`],t[n.variant]]}})((({ownerState:e,theme:t})=>(0,P.A)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:Q(t,e.color)},"inherit"===e.color&&"buffer"!==e.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===e.variant&&{backgroundColor:"transparent"},"query"===e.variant&&{transform:"rotate(180deg)"}))),z=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.dashed,t[`dashedColor${(0,x.A)(n.color)}`]]}})((({ownerState:e,theme:t})=>{const n=Q(t,e.color);return(0,P.A)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===e.color&&{opacity:.3},{backgroundImage:`radial-gradient(${n} 0%, ${n} 16%, transparent 42%)`,backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})}),(0,C.css)(N||(N=G`
    animation: ${0} 3s infinite linear;
  `),q)),K=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t[`barColor${(0,x.A)(n.color)}`],("indeterminate"===n.variant||"query"===n.variant)&&t.bar1Indeterminate,"determinate"===n.variant&&t.bar1Determinate,"buffer"===n.variant&&t.bar1Buffer]}})((({ownerState:e,theme:t})=>(0,P.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"determinate"===e.variant&&{transition:"transform .4s linear"},"buffer"===e.variant&&{zIndex:1,transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,C.css)(F||(F=G`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    `),_))),J=(0,a.Ay)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.bar,t[`barColor${(0,x.A)(n.color)}`],("indeterminate"===n.variant||"query"===n.variant)&&t.bar2Indeterminate,"buffer"===n.variant&&t.bar2Buffer]}})((({ownerState:e,theme:t})=>(0,P.A)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==e.variant&&{backgroundColor:"inherit"===e.color?"currentColor":(t.vars||t).palette[e.color].main},"inherit"===e.color&&{opacity:.3},"buffer"===e.variant&&{backgroundColor:Q(t,e.color),transition:"transform .4s linear"})),(({ownerState:e})=>("indeterminate"===e.variant||"query"===e.variant)&&(0,C.css)(B||(B=G`
      width: auto;
      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
    `),U))),Y=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiLinearProgress"}),{className:r,color:a="primary",value:i,valueBuffer:o,variant:l="indeterminate"}=n,c=(0,E.A)(n,k),s=(0,P.A)({},n,{color:a,variant:l}),u=(e=>{const{classes:t,variant:n,color:r}=e,a={root:["root",`color${(0,x.A)(r)}`,n],dashed:["dashed",`dashedColor${(0,x.A)(r)}`],bar1:["bar",`barColor${(0,x.A)(r)}`,("indeterminate"===n||"query"===n)&&"bar1Indeterminate","determinate"===n&&"bar1Determinate","buffer"===n&&"bar1Buffer"],bar2:["bar","buffer"!==n&&`barColor${(0,x.A)(r)}`,"buffer"===n&&`color${(0,x.A)(r)}`,("indeterminate"===n||"query"===n)&&"bar2Indeterminate","buffer"===n&&"bar2Buffer"]};return(0,S.A)(a,M,t)})(s),p=(0,O.A)(),d={},m={bar1:{},bar2:{}};if(("determinate"===l||"buffer"===l)&&void 0!==i){d["aria-valuenow"]=Math.round(i),d["aria-valuemin"]=0,d["aria-valuemax"]=100;let e=i-100;"rtl"===p.direction&&(e=-e),m.bar1.transform=`translateX(${e}%)`}if("buffer"===l&&void 0!==o){let e=(o||0)-100;"rtl"===p.direction&&(e=-e),m.bar2.transform=`translateX(${e}%)`}return(0,L.jsxs)($,(0,P.A)({className:(0,w.A)(u.root,r),ownerState:s,role:"progressbar"},d,{ref:t},c,{children:["buffer"===l?(0,L.jsx)(z,{className:u.dashed,ownerState:s}):null,(0,L.jsx)(K,{className:u.bar1,ownerState:s,style:m.bar1}),"determinate"===l?null:(0,L.jsx)(J,{className:u.bar2,ownerState:s,style:m.bar2})]}))})),H=Y;var X=n(34339);function Z(e){var t=e.title,n=e.children;return r.createElement(p.Ay,{container:!0},r.createElement(p.Ay,{item:!0,sm:!1,md:3}),r.createElement(p.Ay,{item:!0,sm:12,md:6},r.createElement(p.Ay,{container:!0,sx:{pt:2}},r.createElement(p.Ay,{item:!0,md:12,sx:{mb:3}},t),r.createElement(p.Ay,{item:!0,xs:12,md:12},r.createElement(X.A,{elevation:0,sx:{p:5}},n)))))}Z.propTypes={title:s().element.isRequired,children:s().arrayOf(s().element).isRequired};var ee=n(1043),te=n(25239),ne=n(19455),re=n(92728),ae=n(69554),ie=n(48805),oe=n(45359),le=n(6347),ce=n(69307),se=n(53215),ue=n(46477),pe=n(1403),de=n(90431),me=n(3542);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function ye(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=he(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||he(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ee(e,t,n){var r;return r=function(e,t){if("object"!=fe(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=fe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==fe(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pe="DefaultAPIForm",we={mandatoryStar:"".concat(Pe,"-mandatoryStar"),helperTextContext:"".concat(Pe,"-helperTextContext"),endpointValidChip:"".concat(Pe,"-endpointValidChip"),endpointInvalidChip:"".concat(Pe,"-endpointInvalidChip"),endpointErrorChip:"".concat(Pe,"-endpointErrorChip"),iconButton:"".concat(Pe,"-iconButton"),iconButtonValid:"".concat(Pe,"-iconButtonValid"),radioOutline:"".concat(Pe,"-radioOutline"),label:"".concat(Pe,"-label"),newLabel:"".concat(Pe,"-newLabel")},Se=(0,a.Ay)(p.Ay)((function(e){var t=e.theme;return Ee(Ee(Ee(Ee(Ee(Ee(Ee(Ee(Ee(Ee({},"& .".concat(we.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)}),"& .".concat(we.helperTextContext),{"& p":{textOverflow:"ellipsis",width:400,display:"block",whiteSpace:"nowrap",overflow:"hidden"}}),"& .".concat(we.endpointValidChip),{color:"green",border:"1px solid green"}),"& .".concat(we.endpointInvalidChip),{color:"#ffd53a",border:"1px solid #ffd53a"}),"& .".concat(we.endpointErrorChip),{color:"red",border:"1px solid red"}),"& .".concat(we.iconButton),{padding:t.spacing(1)}),"& .".concat(we.iconButtonValid),{padding:t.spacing(1),color:me.A[500]}),"& .".concat(we.radioOutline),{display:"flex",alignItems:"center",padding:"10px",marginTop:"10px",marginLeft:"15px",marginRight:"8px",borderRadius:"8px",transition:"border 0.3s","&.Mui-checked":{border:"2px solid ".concat(t.palette.primary.main)}}),"& .".concat(we.label),{marginLeft:"10px"}),"& .".concat(we.newLabel),{backgroundColor:"green",color:"white",fontWeight:"bold",fontSize:"0.6rem",padding:"2px 4px",borderRadius:"4px",marginLeft:"10px",display:"inline-block"})}));function Ce(e,t){var n,r=e.context,a=e.version;return n=t?"{channel}/{version}":"{context}/{version}",r&&(n=r,r.indexOf("{version}")<0&&(n=r+"/{version}")),a&&(n=n.replace("{version}",a)),n}function Ie(e,t){var n,r=de.A.getUser();r.name&&-1!==r.name.indexOf("@")&&(n=r.name.split("@")[r.name.split("@").length-1]);var a=e.startsWith("/")?e.toLowerCase():"/"+e.toLowerCase();return null!=n&&"carbon.super"!==n&&(a="/t/"+n+a.toLowerCase()),void 0!==t.find((function(e){return e.context.toLowerCase()===a.toLowerCase()||e.contextTemplate.toLowerCase()===a.toLowerCase()}))}function xe(e){var t=e.onChange,n=e.onValidate,a=e.api,i=e.isAPIProduct,o=e.multiGateway,l=e.isWebSocket,c=e.children,s=e.appendChildrenBeforeEndpoint,d=e.hideEndpoint,f=ge((0,r.useState)({}),2),y=f[0],v=f[1],A=ge((0,r.useState)(),2),b=A[0],E=A[1],P=ge((0,r.useState)(""),2),w=P[0],S=P[1],C=ge((0,r.useState)(!1),2),I=C[0],x=C[1],O=ge((0,r.useState)(!1),2),j=O[0],T=O[1],D=function(e){return a.gatewayType===e?"2px solid #1976D2":"2px solid gray"};(0,r.useEffect)((function(){n(Boolean(a.name)&&Boolean(a.version)&&Boolean(a.context))}),[]);var M,L,k,W=function(e){var t=Object.entries(e).length>0&&Object.entries(e).map((function(e){return null==ge(e,2)[1]})).reduce((function(e,t){return e&&t}));t=t&&Boolean(a.name)&&Boolean(a.version)&&Boolean(a.context),n(t,y),v(e)};function R(e,t){switch(e){case"name":var n=ie.A.apiName.validate(t,{abortEarly:!1}).error;null===n?ie.A.apiParameter.validate(e+":"+t).then((function(e){var r;e.body.list.length>0&&t.toLowerCase()===(null===(r=e.body.list[0].name)||void 0===r?void 0:r.toLowerCase())?W(Ae(Ae({},y),{},{name:{details:[{message:"Name "+t+" already exists"}]}})):W(Ae(Ae({},y),{},{name:n}))})):W(Ae(Ae({},y),{},{name:n}));break;case"context":var r=ie.A.apiContext.required().validate(t,{abortEarly:!1}).error,a=t.startsWith("/")?t:"/"+t;if(null===r){var i,o=ye(a.split("/"));try{for(o.s();!(i=o.n()).done;){var c=i.value;null!==c&&"{version}"!==c&&(c.includes("{version}")?(r=ie.A.apiContextWithoutKeyWords.required().validate(t,{abortEarly:!1}).error,W(Ae(Ae({},y),{},{context:{details:[{message:"{version} cannot exist as a substring in a path param"}]}}))):(c.includes("{")||c.includes("}"))&&(r=ie.A.apiContextWithoutKeyWords.required().validate(t,{abortEarly:!1}).error,W(Ae(Ae({},y),{},{context:{details:[{message:"{ or } cannot exist as a substring in a path param"}]}}))))}}catch(e){o.e(e)}finally{o.f()}var s=0;if(null===r){var u,p=ye(a);try{for(p.s();!(u=p.n()).done;){var d=u.value;"("===d?s++:")"===d&&s--,s<0&&W(Ae(Ae({},y),{},{context:{details:[{message:"Parentheses should be balanced in API context"}]}}))}}catch(e){p.e(e)}finally{p.f()}s>0&&W(Ae(Ae({},y),{},{context:{details:[{message:"Parentheses should be balanced in API context"}]}}))}null===r&&0===s&&ie.A.apiParameter.validate(e+":"+a).then((function(e){var n=e.body.list.length;n>0&&Ie(t,e.body.list)?W(Ae(Ae({},y),{},{context:{details:[{message:l?a+" channel already exists":a+" context already exists"}]}})):n>0&&Ie(t,e.body.list)?W(Ae(Ae({},y),{},{context:{details:[{message:a+" dynamic context already exists"}]}})):W(Ae(Ae({},y),{},{context:r,version:null}))}))}else W(Ae(Ae({},y),{},{context:r}));break;case"version":var m=ie.A.apiVersion.required().validate(t).error;W(Ae(Ae({},y),{},{version:m}));break;case"endpoint":if(l&&t&&t.length>0){var f=ie.A.wsUrl.validate(t).error;W(Ae(Ae({},y),{},{endpointURL:f}))}}}return r.createElement(Se,{item:!0,md:12},r.createElement("form",{noValidate:!0,autoComplete:"off"},r.createElement(ee.A,{autoFocus:!0,fullWidth:!0,id:"api-name",error:Boolean(y.name),label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.name",defaultMessage:[{type:0,value:"Name"}]}),r.createElement("sup",{className:we.mandatoryStar},"*")),helperText:y.name&&y.name.details.map((function(e,t){return r.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)})),value:a.name,name:"name",onChange:t,InputProps:{id:"itest-id-apiname-input",onBlur:function(e){R("name",e.target.value)}},InputLabelProps:{for:"itest-id-apiname-input"},margin:"normal",variant:"outlined"}),r.createElement(p.Ay,{container:!0,spacing:2},i?r.createElement(r.Fragment,null,r.createElement(p.Ay,{item:!0,md:8,xs:6},r.createElement(ee.A,{fullWidth:!0,id:"context",error:Boolean(y.context),label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.api.product.context",defaultMessage:[{type:0,value:"Context"}]}),r.createElement("sup",{className:we.mandatoryStar},"*")),name:"context",value:a.context,onChange:t,InputProps:{onBlur:function(e){R("context",e.target.value)}},helperText:y.context&&y.context.details.map((function(e,t){return r.createElement("div",{key:e.message,style:{marginTop:0!==t&&"10px"}},e.message)}))||"API Product will be exposed in ".concat(Ce(a)," context at the gateway"),margin:"normal",variant:"outlined"})),r.createElement(p.Ay,{item:!0,md:4,xs:6},r.createElement(ee.A,{fullWidth:!0,id:"version",error:Boolean(y.version),label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.api.product.version",defaultMessage:[{type:0,value:"Version"}]}),r.createElement("sup",{className:we.mandatoryStar},"*")),name:"version",value:a.version,onChange:t,InputProps:{id:"itest-id-apiversion-input",onBlur:function(e){R("version",e.target.value)}},InputLabelProps:{for:"itest-id-apiversion-input"},helperText:y.version&&y.version.message,margin:"normal",variant:"outlined"}))):r.createElement(r.Fragment,null,r.createElement(p.Ay,{item:!0,md:8,xs:6},r.createElement(ee.A,{fullWidth:!0,id:"context",error:Boolean(y.context),label:r.createElement(r.Fragment,null,l?r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.api.channel",defaultMessage:[{type:0,value:"Channel"}]}):r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.api.context",defaultMessage:[{type:0,value:"Context"}]}),r.createElement("sup",{className:we.mandatoryStar},"*")),name:"context",value:a.context,onChange:t,InputProps:{id:"itest-id-apicontext-input",onBlur:function(e){R("context",e.target.value)}},InputLabelProps:{for:"itest-id-apicontext-input"},helperText:y.context&&y.context.details.map((function(e,t){return r.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)}))||"API will be exposed in ".concat(Ce(a,l)," context at the gateway"),classes:{root:we.helperTextContext},margin:"normal",variant:"outlined"})),r.createElement(p.Ay,{item:!0,md:4,xs:6},r.createElement(ee.A,{fullWidth:!0,id:"version",error:Boolean(y.version),label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.Components.DefaultAPIForm.version",defaultMessage:[{type:0,value:"Version"}]}),r.createElement("sup",{className:we.mandatoryStar},"*")),name:"version",value:a.version,onChange:t,InputProps:{id:"itest-id-apiversion-input",onBlur:function(e){R("version",e.target.value)}},InputLabelProps:{for:"itest-id-apiversion-input"},helperText:y.version&&y.version.message,margin:"normal",variant:"outlined"})))),s&&!!c&&c,!i&&!d&&r.createElement(ee.A,{fullWidth:!0,id:"itest-id-apiendpoint-input",label:"Endpoint",name:"endpoint",value:a.endpoint,onChange:t,helperText:y.endpointURL&&y.endpointURL.details.map((function(e,t){return r.createElement("div",{style:{marginTop:0!==t&&"10px"}},e.message)})),error:Boolean(y.endpointURL),margin:"normal",variant:"outlined",InputProps:{onBlur:function(e){R("endpoint",e.target.value)},endAdornment:r.createElement(te.A,{position:"end"},w&&r.createElement(ae.A,{label:w,className:b?we.endpointValidChip:(M=j,L=we.endpointErrorChip,k=we.endpointInvalidChip,M?L:k),variant:"outlined"}),!l&&r.createElement(ne.A,{className:b?we.iconButtonValid:we.iconButton,"aria-label":"TestEndpoint",onClick:function(){return e=a.endpoint,x(!0),void(new h.A).testEndpoint(e).then((function(e){null!==e.body.error?(S(e.body.error),T(!0)):(S(e.body.statusCode+" "+e.body.statusMessage),T(!1)),e.body.statusCode>=200&&e.body.statusCode<300?(E(!0),T(!1)):E(!1)})).finally((function(){x(!1)}));var e},disabled:I,size:"large"},I?r.createElement(g.A,{size:20}):r.createElement(re.A,null,"check_circle")))}}),o&&r.createElement(p.Ay,{container:!0,spacing:2},r.createElement(oe.A,{component:"fieldset"},r.createElement(ce.A,{sx:{marginLeft:"15px",marginTop:"20px"}},"Select Gateway type"),r.createElement(ue.A,{row:!0,"aria-label":"gateway-type",name:"gatewayType",value:a.gatewayType,onChange:t},r.createElement(p.Ay,{item:!0,xs:6},r.createElement(pe.A,{value:"wso2/synapse",className:we.radioOutline,control:r.createElement(se.A,null),label:r.createElement("div",null,r.createElement("span",null,"Regular Gateway"),r.createElement(u.A,{variant:"body2",color:"textSecondary"},"API gateway embedded in APIM runtime. Connect directly APIManager.")),sx:{border:D("wso2/synapse")}})),r.createElement(p.Ay,{item:!0,xs:6},r.createElement(pe.A,{value:"wso2/apk",className:we.radioOutline,control:r.createElement(se.A,null),label:r.createElement("div",null,r.createElement("span",null,"APK Gateway"),r.createElement("span",{className:"".concat(we.label," ").concat(we.newLabel)},"New"),r.createElement(u.A,{variant:"body2",color:"textSecondary"},"Fast API gateway running on kubernetes designed to manage and secure APIs.")),sx:{border:D("wso2/apk")}}))),r.createElement(le.A,{sx:{marginLeft:"15px"}},"Select the gateway type where your API will run."))),!s&&!!c&&c),r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-end",alignItems:"center"},r.createElement(p.Ay,{item:!0},r.createElement(u.A,{variant:"caption",display:"block",gutterBottom:!0},r.createElement("sup",{style:{color:"red"}},"*")," ","Mandatory fields"))))}xe.defaultProps={onValidate:function(){},api:{},isWebSocket:!1},xe.propTypes={api:s().shape({}),multiGateway:s().string.isRequired,isAPIProduct:s().shape({}).isRequired,isWebSocket:s().shape({}),onChange:s().func.isRequired,onValidate:s().func};var Oe=n(14739),je=n(85877);function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){var r;return r=function(e,t){if("object"!=Te(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=Te(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Te(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ke(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Re(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function We(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||Re(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){if(e){if("string"==typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ne(){Ne=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof A?t:A,o=Object.create(i.prototype),l=new T(r||[]);return a(o,"_invoke",{value:I(e,n,l)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",m="suspendedYield",f="executing",y="completed",v={};function A(){}function g(){}function h(){}var b={};s(b,o,(function(){return this}));var E=Object.getPrototypeOf,P=E&&E(E(D([])));P&&P!==n&&r.call(P,o)&&(b=P);var w=h.prototype=A.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(a,i,o,l){var c=p(e[a],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Te(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,l)}),(function(e){n("throw",e,o,l)})):t.resolve(u).then((function(e){s.value=e,o(s)}),(function(e){return n("throw",e,o,l)}))}l(c.arg)}var i;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return i=i?i.then(a,a):a()}})}function I(t,n,r){var a=d;return function(i,o){if(a===f)throw new Error("Generator is already running");if(a===y){if("throw"===i)throw o;return{value:e,done:!0}}for(r.method=i,r.arg=o;;){var l=r.delegate;if(l){var c=x(l,r);if(c){if(c===v)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var s=p(t,n,r);if("normal"===s.type){if(a=r.done?y:m,s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(a=y,r.method="throw",r.arg=s.arg)}}}function x(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=p(a,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Te(t)+" is not iterable")}return g.prototype=h,a(w,"constructor",{value:h,configurable:!0}),a(h,"constructor",{value:g,configurable:!0}),g.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},S(C.prototype),s(C.prototype,l,(function(){return this})),t.AsyncIterator=C,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new C(u(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(w),s(w,c,"Generator"),s(w,o,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return l.type="throw",l.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],l=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),s=r.call(o,"finallyLoc");if(c&&s){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;j(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function Fe(e,t,n,r,a,i,o){try{var l=e[i](o),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function Be(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Fe(i,r,a,o,l,"next",e)}function l(e){Fe(i,r,a,o,l,"throw",e)}o(void 0)}))}}var Ge=function(){var e=Be(Ne().mark((function e(){var t,n;return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=h.A.policies("subscription"),e.next=3,t;case 3:return n=e.sent,e.abrupt("return",n.body.list);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function _e(e){var t=e.isWebSocket,n=e.isAPIProduct,a=e.history,i=e.intl,o=e.multiGateway,c=(0,l.Jy)(),s=c.data,f=c.isLoading,E=c.error,P=We((0,r.useState)(!1),2),w=P[0],S=P[1],C=We((0,r.useState)(null),2),I=C[0],x=C[1];(0,r.useEffect)((function(){E&&x(E.message)}),[E]),(0,r.useEffect)((function(){if(null!=s&&s.gatewayTypes&&1===s.gatewayTypes.length){var e,t=ke(s.environment);try{for(t.s();!(e=t.n()).done;)if(e.value.gatewayType===s.gatewayTypes[0]){S(!0);break}}catch(e){t.e(e)}finally{t.f()}}}),[s]);var O=We((0,r.useState)(),2),j=O[0],T=O[1],D=We((0,r.useState)(!1),2),M=D[0],L=D[1],k=We((0,r.useState)(!1),2),W=k[0],R=k[1],V=We((0,r.useState)(!1),2),N=V[0],F=V[1],B=We((0,r.useState)(!1),2),G=B[0],_=B[1],U=We((0,r.useState)(!1),2),q=U[0],Q=U[1],$=We((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"name":case"version":case"endpoint":case"context":case"gatewayType":case"isFormValid":return Me(Me({},e),{},Le({},n,r));default:return e}}),{formValidity:!1}),2),z=$[0],K=$[1],J=z.endpoint,Y=!(z.name&&z.version&&z.context)||j||M;function X(){return ee.apply(this,arguments)}function ee(){return ee=Be(Ne().mark((function e(){var r,o,l,c,u,p,d,m,f,y,v,g;return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(!0),r=z.name,o=z.version,l=z.context,c=z.endpoint,u=z.gatewayType,e.next=4,Ge();case 4:return 0===(f=e.sent).length?A.A.info(i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):d=f.filter((function(e){return"Unlimited"===e.name})).length>0?["Unlimited"]:[f[0].name],m=s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("Regular")?"wso2/synapse":s&&1===s.gatewayTypes.length&&s.gatewayTypes.includes("APK")?"wso2/apk":"default",y={name:r,version:o,context:l,gatewayType:"default"===m?u:m,policies:d},c&&(y.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:c},production_endpoints:{url:c}}),t&&(y.type="WS"),n?(v=new Oe.A(y),p=v.saveProduct(y).then((function(e){return A.A.info("API Product created successfully"),a.push("/api-products/".concat(e.id,"/overview")),e})).catch((function(e){if(console.error(e),e.response)return x(e.response.body),e.response.body.description;var t="Something went wrong while adding the API Product";return x(t),t}))):(g=new h.A(y),p=g.save(),A.A.loading(p,{loading:"Creating API...",success:"API created successfully",error:function(e){if(console.error(e),L(!1),e.response)return x(e.response.body),e.response.body.description;var t="Something went wrong while adding the API";return x(t),t}})),e.abrupt("return",p.finally((function(){return T(!1)})));case 12:case"end":return e.stop()}}),e)}))),ee.apply(this,arguments)}(0,r.useEffect)((function(){null!=s&&s.customProperties&&s.customProperties.length>0&&_(!0)}),[s]);var te=r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5",component:"h1"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.api.heading",defaultMessage:[{type:0,value:"Create an API"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version, a Context and Backend Endpoint (optional)"}]})));return n?te=r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5",component:"h1"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.apiProduct.heading",defaultMessage:[{type:0,value:"Create an API Product"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.apiProduct.sub.heading",defaultMessage:[{type:0,value:"Create an API Product by providing a Name, a Context, and Business Plans (optional)."}]}))):t&&(te=r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5",component:"h1"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.webSocket.heading",defaultMessage:[{type:0,value:"Create a WebSocket API"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.webSocket.sub.heading",defaultMessage:[{type:0,value:"Create a WebSocket API by providing a Name, and a Context."}]})))),f?r.createElement(je.A,null):r.createElement(Z,{title:te},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"center",alignItems:"center"},I&&r.createElement(p.Ay,{item:!0,xs:11},r.createElement(b.A,{onClose:function(){return x(null)},disableActions:!0,dense:!0,paperProps:{elevation:1},type:"error",message:I})),r.createElement(p.Ay,{item:!0,xs:12},f&&r.createElement(d.A,{mt:-2},r.createElement(H,{"data-testid":"loading-publisher-settings"}))),r.createElement(p.Ay,{item:!0,xs:12,"data-testid":"default-api-form"},r.createElement(xe,{onValidate:function(e){K({action:"isFormValid",value:e})},onChange:function(e){var t=e.target,n=t.name,r=t.value;K({action:n,value:r});var a=s&&s.environment;if(s&&2===s.gatewayTypes.length&&("wso2/synapse"===r||"wso2/apk"===r)){var i,o=ke(a);try{for(o.s();!(i=o.n()).done;){var l=i.value,c="";if("APK"===l.gatewayType?c="wso2/apk":"Regular"===l.gatewayType&&(c="wso2/synapse"),c===r){S(!0);break}S(!1)}}catch(e){o.e(e)}finally{o.f()}}},api:z,multiGateway:o,isAPIProduct:n,isWebSocket:t})),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},r.createElement(y.A,{id:"itest-create-default-api-button",variant:"contained",color:"primary",disabled:Y||!z.isFormValid,onClick:function(){X().then((function(e){a.push("/apis/".concat(e.id,"/overview"))}))}},"Create"," ",j&&!q&&r.createElement(g.A,{size:24}))),!G&&!de.A.isNotPublisher()&&r.createElement(p.Ay,{item:!0},r.createElement(y.A,{id:"itest-id-apicreatedefault-createnpublish",variant:"contained",color:"primary",disabled:!w||N||W||!J||Y||!z.isFormValid,onClick:function(){var e=new h.A;Q(!0),X().then((function(t){R(!0);var n=e.createRevision(t.id,{description:"Initial Revision"});A.A.loading(n,{success:"API revision created successfully",error:function(e){return console.error(e),e.response?(x(e.response.body),e.response.body.description):(x("Something went wrong while creating the API Revision"),i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Revision"}]}))},loading:"Creating API revision..."}),n.then((function(n){var r=n.body.id;R(!1);var o=s.environment.map((function(e){return e.name})),l=[],c=s.environment.filter((function(e){return e.provider&&e.provider.toLowerCase().includes("wso2")})),u=function(e){var t=c.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};if(s.gatewayTypes&&1===s.gatewayTypes.length)o&&o.length>0&&(o.includes("Default")&&u("Default")?l.push({name:"Default",displayOnDevportal:!0,vhost:u("Default")}):u(o[0])&&l.push({name:o[0],displayOnDevportal:!0,vhost:u(o[0])}));else{var p=s.environment,d=!1;p.forEach((function(e){var t="";"APK"===e.gatewayType?t="wso2/apk":"Regular"===e.gatewayType&&(t="wso2/synapse"),!d&&t===z.gatewayType&&u(e.name)&&(l.push({name:e.name,displayOnDevportal:!0,vhost:u(e.name)}),d=!0)}))}F(!0);var m=e.deployRevision(t.id,r,l);A.A.loading(m,{loading:"Deploying API...",success:"API deployed successfully",error:function(e){return console.error(e),e.response?(x(e.response.body),e.response.body.description):(x("Something went wrong while publishing the API"),i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.publish",defaultMessage:[{type:0,value:"Something went wrong while publishing the API"}]}))}}),m.then((function(e){if(F(!1),"CREATED"===e.body[0].status)L(!1),Q(!1),a.push("/apis/".concat(t.id,"/overview"));else{L(!0);var n=t.publish();A.A.loading(n,{loading:"Publishing API...",success:function(e){return e.body.workflowStatus===_e.WORKFLOW_STATUS.CREATED?i.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]}):i.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.otherStatus",defaultMessage:[{type:0,value:"API updated successfully"}]})},error:function(){return i.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.otherStatus",defaultMessage:[{type:0,value:"Error while publishing the API"}]})}}),n.then((function(){return a.push("/apis/".concat(t.id,"/overview"))})).finally((function(){L(!1),Q(!1)}))}})).finally((function(){F(!1)}))})).finally((function(){R(!1)}))}))}},!M&&!W&&!N&&"Create & Publish",(M||W||N)&&r.createElement(g.A,{size:24}),j&&M&&"Creating API . . .",!j&&W&&!N&&"Creating Revision . . .",!j&&M&&!W&&!N&&"Publishing API . . .",!j&&M&&!W&&N&&"Deploying Revision . . .")),r.createElement(p.Ay,{item:!0},r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,{variant:"text"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))))))),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(d.A,{mt:4})))}_e.defaultProps={isWebSocket:!1,isAPIProduct:!1},_e.WORKFLOW_STATUS={CREATED:"CREATED"},_e.propTypes={history:s().shape({push:s().func}).isRequired,multiGateway:s().string.isRequired,isAPIProduct:s().shape({}),isWebSocket:s().shape({}),intl:s().shape({formatMessage:s().func}).isRequired};const Ue=(0,i.y)((0,f.Ay)(_e));var qe=n(6442),Qe=n(79595),$e=n(82997),ze=n(47363);function Ke(e){var t=e.title,n=e.children;return r.createElement(p.Ay,{container:!0},r.createElement(p.Ay,{item:!0,sm:!1,md:2}),r.createElement(p.Ay,{item:!0,sm:12,md:8},r.createElement(p.Ay,{container:!0,sx:{pt:2}},r.createElement(p.Ay,{item:!0,md:12,sx:{mb:3}},t),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(X.A,{elevation:0,sx:{p:5}},n)))))}Ke.propTypes={title:s().element.isRequired,children:s().element.isRequired};var Je=n(19922);function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tt(e,t,n){var r;return r=function(e,t){if("object"!=Ye(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=Ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==Ye(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var nt="APIProductCreateWrapper",rt={Paper:"".concat(nt,"-Paper"),saveButton:"".concat(nt,"-saveButton"),titleWrapper:"".concat(nt,"-titleWrapper"),buttonWrapper:"".concat(nt,"-buttonWrapper"),alternativeLabel:"".concat(nt,"-alternativeLabel")},at=(0,a.Ay)("div")((function(e){var t=e.theme;return tt(tt(tt(tt(tt({},"& .".concat(rt.Paper),{height:"40px"}),"& .".concat(rt.saveButton),{padding:"0px 0px 0px 10px"}),"& .".concat(rt.titleWrapper),{display:"flex",flexDirection:"row",alignItems:"center",paddingBottom:t.spacing(2)}),"& .".concat(rt.buttonWrapper),{marginTop:t.spacing(4)}),"& .".concat(rt.alternativeLabel),{marginTop:t.spacing(1)})}));function it(e){var t=e.history,n=(0,qe.A)(),a=Ze((0,r.useState)(0),2),i=a[0],o=a[1],c=Ze((0,r.useState)([]),2),s=c[0],f=c[1],b=(0,l.Jy)().data,E=Ze((0,r.useState)(!1),2),P=E[0],w=E[1],S=Ze((0,r.useState)(!1),2),C=S[0],I=S[1],x=Ze((0,r.useState)(!1),2),O=x[0],j=x[1],T=Ze((0,r.useState)(!1),2),D=T[0],M=T[1],L=Ze((0,r.useState)([]),2),k=L[0],W=L[1];(0,r.useEffect)((function(){h.A.policies("subscription").then((function(e){var t=e.body.list;0===t.length?A.A.info(n.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):t.filter((function(e){return"Unlimited"===e.name})).length>0?W(["Unlimited"]):W([t[0].name])}))}),[]);var R,V=r.createElement(at,null,r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.heading",defaultMessage:[{type:0,value:"Create an API Product"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.sub.heading",defaultMessage:[{type:0,value:"Create an API Product by providing a Name, a Context, a Version, Resources, and Business Plans (optional)."}]}))),N=Ze((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"type":case"name":case"context":case"version":case"isFormValid":case"apiResources":return Xe(Xe({},e),{},tt({},n,r));case"preSetAPI":return Xe(Xe({},e),{},{name:r.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),context:r.context});default:return e}}),{type:"ApiProductCreateWrapper",inputValue:"",formValidity:!1}),2),F=N[0],B=N[1],G=Ze((0,r.useState)(),2),_=G[0],U=G[1],q=[r.createElement(m.A,{variant:"caption",id:"Apis.Create.APIProduct.APIProductCreateWrapper.defineProvide",defaultMessage:[{type:0,value:"Define API Product"}]}),r.createElement(m.A,{variant:"caption",id:"Apis.Create.APIProduct.APIProductCreateWrapper.resources",defaultMessage:[{type:0,value:"Add Resources"}]})],Q=function(){U(!0);var e={name:F.name,context:F.context,version:F.version,policies:k,apis:s,transport:["http","https"]};return(R=new Oe.A(e)).saveProduct(e).then((function(e){return A.A.info("API Product created successfully"),e})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API Product")})).finally((function(){return U(!1)})).finally((function(){return U(!1)}))};return r.createElement(r.Fragment,null,r.createElement(Ke,{title:V},r.createElement(d.A,{sx:{mb:3}},0===i&&r.createElement(Qe.A,{alternativeLabel:!0,activeStep:0},q.map((function(e){return r.createElement($e.A,{key:e},r.createElement(ze.A,{className:rt.alternativeLabel},e))}))),1===i&&r.createElement(Qe.A,{alternativeLabel:!0,activeStep:1},q.map((function(e){return r.createElement($e.A,{key:e},r.createElement(ze.A,null,e))})))),r.createElement(p.Ay,{container:!0},r.createElement(p.Ay,{item:!0,md:12},0===i&&r.createElement(xe,{onValidate:function(e){B({action:"isFormValid",value:e})},onChange:function(e){var t=e.target,n=t.name,r=t.value;B({action:n,value:r})},api:F,isAPIProduct:!0}),1===i&&r.createElement(Je.A,{apiResources:s,setApiResources:f,isStateCreate:!0,api:F})),r.createElement(p.Ay,{item:!0,md:12,sx:{mt:3}},r.createElement(p.Ay,{className:1===i&&rt.saveButton,container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},1===i&&r.createElement(y.A,{onClick:function(){return o((function(e){return e-1}))}},r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.back",defaultMessage:[{type:0,value:"Back"}]})),0===i&&r.createElement(v.N_,{to:"/api-products/"},r.createElement(y.A,null,r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.cancel",defaultMessage:[{type:0,value:"Cancel"}]})))),r.createElement(p.Ay,{item:!0},1===i&&r.createElement(y.A,{variant:"contained",color:"primary",disabled:!F.isFormValid||_||0===s.length||P,onClick:function(){Q().then((function(e){t.push("/api-products/".concat(e.id,"/overview"))}))},id:"create-api-product-btn"},r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.create",defaultMessage:[{type:0,value:"Create"}]}),_&&!P&&r.createElement(g.A,{size:24})),0===i&&r.createElement(y.A,{onClick:function(){return o((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!F.isFormValid,id:"api-product-next-btn"},r.createElement(m.A,{id:"Apis.Create.APIProduct.APIProductCreateWrapper.next",defaultMessage:[{type:0,value:"Next"}]}))),r.createElement(p.Ay,{item:!0},1===i&&!de.A.isNotPublisher()&&r.createElement(y.A,{variant:"contained",color:"primary",id:"create-and-publish-api-product-btn",disabled:!F.isFormValid||_||0===s.length||O||C||!F.isFormValid,onClick:function(){w(!0),Q().then((function(e){I(!0),A.A.info("API Product created successfully"),R.createProductRevision(e.id,{description:"Initial Revision"}).then((function(r){I(!1);var a=r.body.id;A.A.info("API Revision created successfully");var i=b.environment.map((function(e){return e.name})),o=[],l=function(e){var t=b.environment.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};i&&i.length>0&&(i.includes("Default")&&l("Default")?o.push({name:"Default",displayOnDevportal:!0,vhost:l("Default")}):l(i[0])&&o.push({name:i[0],displayOnDevportal:!0,vhost:l(i[0])})),j(!0),R.deployProductRevision(e.id,a,o).then((function(){A.A.info("API Product Revision Deployed Successfully"),j(!1),M(!0),R.updateLcState(e.id,"Publish").then((function(r){"CREATED"===r.body.workflowStatus?A.A.info(n.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]})):A.A.info(n.formatMessage({id:"Apis.Create.APIProduct.APIProductCreateWrapper.otherStatus",defaultMessage:[{type:0,value:"API Product status updated successfully"}]})),t.push("/api-products/".concat(e.id,"/overview"))}))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error(n.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.deploy.revision",defaultMessage:[{type:0,value:"Something went wrong while deploying the API Product Revision"}]})),console.error(e)})).finally((function(){M(!1),w(!1)}))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error(n.formatMessage({id:"Apis.APIProductCreateWrapper.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Product Revision"}]})),console.error(e)}))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API Product")})).finally((function(){return U(!1)}))}},!D&&!C&&!O&&"Create & Publish",(D||C||O)&&r.createElement(g.A,{size:24}),_&&D&&"Creating API Product. . .",!_&&C&&!O&&"Creating Revision . . .",!_&&D&&!C&&!O&&"Publishing API Product. . .",!_&&D&&!C&&O&&"Deploying Revision . . .")))))))}it.propTypes={history:s().shape({push:s().func}).isRequired};var ot=n(11354);function lt(e){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lt(e)}function ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return st(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?st(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dt(e,t,n){var r;return r=function(e,t){if("object"!=lt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==lt(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mt(e,t){var n=t.action,r=t.value;switch(n){case"type":case"inputValue":case"name":case"version":case"endpoint":case"gatewayType":case"context":case"policies":case"isFormValid":return pt(pt({},e),{},dt({},n,r));case"inputType":return pt(pt({},e),{},dt(dt({},n,r),"inputValue","url"===r?"":null));case"preSetAPI":return pt(pt({},e),{},{name:r.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:r.version,context:r.context,endpoint:r.endpoints&&r.endpoints[0]});default:return e}}function ft(e){var t=ct((0,r.useState)(0),2),n=t[0],a=t[1],i=e.history,o=e.multiGateway,c=(0,l.Jy)().data,s=ct((0,r.useReducer)(mt,{type:"ApiCreateOpenAPI",inputType:"url",inputValue:"",formValidity:!1}),2),f=s[0],b=s[1];function E(e){b({action:"isFormValid",value:e})}var P=ct((0,r.useState)(),2),w=P[0],S=P[1];return r.createElement(Z,{title:r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.heading",defaultMessage:[{type:0,value:"Create an API using an OpenAPI definition."}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.sub.heading",defaultMessage:[{type:0,value:"Create an API using an existing OpenAPI definition file or URL."}]})))},r.createElement(d.A,{sx:{mb:2}},r.createElement(Qe.A,{alternativeLabel:!0,activeStep:0},r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.wizard.one",defaultMessage:[{type:0,value:"Provide OpenAPI"}]}))),r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),r.createElement(p.Ay,{container:!0,spacing:2},r.createElement(p.Ay,{item:!0,xs:12},0===n&&r.createElement(ot.A,{onValidate:E,apiInputs:f,inputsDispatcher:b}),1===n&&r.createElement(xe,{onValidate:E,onChange:function(e){var t=e.target,n=t.name,r=t.value;b({action:n,value:r})},multiGateway:o,api:f,isAPIProduct:!1})),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},0===n&&r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,null,r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===n&&r.createElement(y.A,{onClick:function(){return a((function(e){return e-1}))}},"Back")),r.createElement(p.Ay,{item:!0},0===n&&r.createElement(y.A,{onClick:function(){return a((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!f.isFormValid,id:"open-api-create-next-btn"},"Next"),1===n&&r.createElement(y.A,{variant:"contained",color:"primary",disabled:!f.isFormValid||w,onClick:function(){S(!0);var e,t=f.name,n=f.version,r=f.context,a=f.endpoint,o=f.gatewayType,l=f.policies,s=void 0===l?["Unlimited"]:l,u=f.inputValue,p=f.inputType,d={name:t,version:n,context:r,gatewayType:"default"==(e=c&&1===c.gatewayTypes.length&&c.gatewayTypes.includes("Regular")?"wso2/synapse":c&&1===c.gatewayTypes.length&&c.gatewayTypes.includes("APK")?"wso2/apk":"default")?o:e,policies:s};a&&(d.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:a},production_endpoints:{url:a}});var m=new h.A(d);("file"===p?m.importOpenAPIByFile(u):m.importOpenAPIByUrl(u)).then((function(e){A.A.info("API created successfully"),i.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API"),console.error(e)})).finally((function(){return S(!1)}))},id:"open-api-create-btn"},"Create"," ",w&&r.createElement(g.A,{size:24})))))))}ft.propTypes={history:s().shape({push:s().func}).isRequired,multiGateway:s().string.isRequired};var yt=n(68810),vt=n(15001),At=n(60326);function gt(e){return(0,D.Ay)("MuiAlertTitle",e)}(0,T.A)("MuiAlertTitle",["root"]);const ht=["className"],bt=(0,a.Ay)(u.A,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({fontWeight:e.typography.fontWeightMedium,marginTop:-2}))),Et=r.forwardRef((function(e,t){const n=(0,j.A)({props:e,name:"MuiAlertTitle"}),{className:r}=n,a=(0,E.A)(n,ht),i=n,o=(e=>{const{classes:t}=e;return(0,S.A)({root:["root"]},gt,t)})(i);return(0,L.jsx)(bt,(0,P.A)({gutterBottom:!0,component:"div",ownerState:i,ref:t,className:(0,w.A)(o.root,r)},a))})),Pt=Et;let wt=!1;const St=r.forwardRef((function(e,t){return wt||(console.warn(["MUI: The AlertTitle component was moved from the lab to the core.","","You should use `import { AlertTitle } from '@mui/material'`","or `import AlertTitle from '@mui/material/AlertTitle'`"].join("\n")),wt=!0),(0,L.jsx)(Pt,(0,P.A)({ref:t},e))}));var Ct=n(51555);function It(e){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},It(e)}function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jt(e,t,n){var r;return r=function(e,t){if("object"!=It(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==It(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Mt(e){var t=(0,qe.A)(),n=Tt((0,r.useState)(0),2),a=n[0],i=n[1],o=e.history,l=Tt((0,r.useState)([]),2),c=l[0],s=l[1];(0,r.useEffect)((function(){h.A.policies("subscription").then((function(e){var n=e.body.list;0===n.length?A.A.info(t.formatMessage({id:"Apis.Create.WSDL.ApiCreateWSDL.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):n.filter((function(e){return"Unlimited"===e.name})).length>0?s(["Unlimited"]):s([n[0].name])}))}),[]);var f=Tt((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"type":case"inputValue":case"name":case"version":case"endpoint":case"context":case"isFormValid":return Ot(Ot({},e),{},jt({},n,r));case"inputType":return Ot(Ot({},e),{},jt(jt({},n,r),"inputValue","url"===r?"":null));default:return e}}),{type:"SOAP",inputType:"url",inputValue:"",formValidity:!1,mode:"create"}),2),b=f[0],E=f[1];function P(e){E({action:"isFormValid",value:e})}var w=Tt((0,r.useState)(),2),S=w[0],C=w[1];return r.createElement(Z,{title:r.createElement(r.Fragment,null,1===a&&"SOAPTOREST"===b.type&&r.createElement(d.A,{mb:2},r.createElement(At.A,{severity:"warning"},r.createElement(St,null,r.createElement(m.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.deprecated.msg",defaultMessage:[{type:0,value:"APIM supports only a limited set of capabilities with this feature. If you want to process complex WSDL/XML schema, please refer to the following documentation."}]})),r.createElement(vt.A,{href:"https://apim.docs.wso2.com/en/4.2.0/integrate/develop/creating-artifacts/creating-an-api/",target:"_blank"},"WSO2 Integration Studio Documentation"))),r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.heading",defaultMessage:[{type:0,value:"Expose a SOAP Service as a REST API"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.WSDL.ApiCreateWSDL.sub.heading",defaultMessage:[{type:0,value:"Expose an existing SOAP service as a REST API by importing the WSDL of the SOAP service."}]})))},r.createElement(d.A,{sx:{mb:2}},r.createElement(Qe.A,{alternativeLabel:!0,activeStep:a},r.createElement($e.A,null,r.createElement(ze.A,null,"Provide WSDL")),r.createElement($e.A,null,r.createElement(ze.A,null,"Create API")))),r.createElement(p.Ay,{container:!0,spacing:2},r.createElement(p.Ay,{item:!0,md:12},0===a&&r.createElement(Ct.A,{onValidate:P,apiInputs:b,inputsDispatcher:E}),1===a&&r.createElement(xe,{onValidate:P,onChange:function(e){var t=e.target,n=t.name,r=t.value;E({action:n,value:r})},api:b,isAPIProduct:!1})),r.createElement(p.Ay,{item:!0,md:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},0===a&&r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,null,r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===a&&r.createElement(y.A,{onClick:function(){return i((function(e){return e-1}))}},"Back")),r.createElement(p.Ay,{item:!0},0===a&&r.createElement(y.A,{onClick:function(){return i((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!b.isFormValid},"Next"),1===a&&r.createElement(y.A,{variant:"contained",color:"primary",disabled:!b.isFormValid||S,onClick:function(){C(!0);var e=b.name,t=b.version,n=b.context,r=b.endpoint,a=b.type,i={name:e,version:t,context:n,policies:c};r&&(i.endpointConfig={endpoint_type:"SOAPTOREST"===a?"address":"http",sandbox_endpoints:{type:"SOAPTOREST"===a?"address":void 0,url:r},production_endpoints:{type:"SOAPTOREST"===a?"address":void 0,url:r}}),("url"===b.inputType?yt.A.importByUrl(b.inputValue,i,b.type):yt.A.importByFileOrArchive(b.inputValue,i,b.type)).then((function(e){A.A.info("API created successfully"),o.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API"),console.error(e)})).finally((function(){return C(!1)}))}},"Create"," ",S&&r.createElement(g.A,{size:24})))))))}Mt.propTypes={history:s().shape({push:s().func}).isRequired};var Lt=n(27601);function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function Wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wt(Object(n),!0).forEach((function(t){Vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e,t,n){var r;return r=function(e,t){if("object"!=kt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==kt(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bt(e){var t=(0,qe.A)(),n=e.multiGateway,a=Nt((0,r.useState)(0),2),o=a[0],c=a[1],s=(0,i.W6)(),f=(0,l.Jy)().data,b=Nt((0,r.useState)([]),2),E=b[0],P=b[1];(0,r.useEffect)((function(){h.A.policies("subscription").then((function(e){var n=e.body.list;0===n.length?A.A.info(t.formatMessage({id:"Apis.Create.GraphQL.ApiCreateGraphQL.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):n.filter((function(e){return"Unlimited"===e.name})).length>0?P(["Unlimited"]):P([n[0].name])}))}),[]);var w=Nt((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"type":case"inputValue":case"name":case"version":case"gatewayType":case"endpoint":case"context":case"isFormValid":case"graphQLInfo":return Rt(Rt({},e),{},Vt({},n,r));case"inputType":return Rt(Rt({},e),{},Vt(Vt({},n,r),"inputValue","url"===r?"":null));case"preSetAPI":return Rt(Rt({},e),{},{name:r.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:r.version,context:r.context});default:return e}}),{type:"ApiCreateGraphQL",inputType:"file",inputValue:"",formValidity:!1}),2),S=w[0],C=w[1];function I(e){C({action:"isFormValid",value:e})}var x=Nt((0,r.useState)(),2),O=x[0],j=x[1];return r.createElement(Z,{title:r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.heading",defaultMessage:[{type:0,value:"Create an API using a GraphQL SDL definition"}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.sub.heading",defaultMessage:[{type:0,value:"Create an API by importing an existing GraphQL SDL definition."}]})))},r.createElement(d.A,{sx:{mb:2}},0===o&&r.createElement(Qe.A,{alternativeLabel:!0,activeStep:0},r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.one",defaultMessage:[{type:0,value:"Provide GraphQL"}]}))),r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.two",defaultMessage:[{type:0,value:"Create API"}]})))),1===o&&r.createElement(Qe.A,{alternativeLabel:!0,activeStep:1},r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.one",defaultMessage:[{type:0,value:"Provide GraphQL"}]}))),r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),r.createElement(p.Ay,{container:!0,spacing:2},r.createElement(p.Ay,{item:!0,md:12},0===o&&r.createElement(Lt.A,{onValidate:I,apiInputs:S,inputsDispatcher:C}),1===o&&r.createElement(xe,{onValidate:I,onChange:function(e){var t=e.target,n=t.name,r=t.value;C({action:n,value:r})},multiGateway:n,api:S,isAPIProduct:!1})),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},0===o&&r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,null,r.createElement(m.A,{id:"Apis.Create.OpenAPI.ApiCreateOpenAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===o&&r.createElement(y.A,{onClick:function(){return c((function(e){return e-1}))}},r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.back",defaultMessage:[{type:0,value:"Back"}]}))),r.createElement(p.Ay,{item:!0},0===o&&r.createElement(y.A,{onClick:function(){return c((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!S.isFormValid,"data-testid":"create-graphql-next-btn"},r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.next",defaultMessage:[{type:0,value:"Next"}]})),1===o&&r.createElement(y.A,{variant:"contained",color:"primary",disabled:!S.isFormValid||O,onClick:function(){j(!0);var e,t=S.name,n=S.version,r=S.context,a=S.endpoint,i=S.gatewayType,o=S.implementationType,l=S.inputValue,c=S.graphQLInfo.operations;e=f&&1===f.gatewayTypes.length&&f.gatewayTypes.includes("Regular")?"wso2/synapse":f&&1===f.gatewayTypes.length&&f.gatewayTypes.includes("APK")?"wso2/apk":"default";var u={name:t,version:n,context:r,gatewayType:"default"===e?i:e,policies:E,operations:c},p="file";a&&(u.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:a},production_endpoints:{url:a}});var d=new h.A(u),m=Vt(Vt({additionalProperties:JSON.stringify(u),implementationType:o},p,p),"file",l);d.importGraphQL(m).then((function(e){var n=e.obj.id;A.A.info("".concat(t," API created successfully")),s.push("/apis/".concat(n,"/overview"))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API"),console.error(e)})).finally((function(){return j(!1)}))},"data-testid":"itest-create-graphql-api-button"},r.createElement(m.A,{id:"Apis.Create.GraphQL.ApiCreateGraphQL.create",defaultMessage:[{type:0,value:"Create"}]})," ",O&&r.createElement(g.A,{size:24})))))))}Bt.propTypes={multiGateway:s().shape({content:s().string}).isRequired};const Gt=function(){return r.createElement(Ue,{isWebSocket:!0})};var _t=n(17681),Ut=n(82241);function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){Jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Jt(e,t,n){var r;return r=function(e,t){if("object"!=qt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==qt(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Yt={mandatoryStar:"".concat("APICreateStreamingAPI","-mandatoryStar")},Ht=(0,a.Ay)(Z)((function(e){var t=e.theme;return Jt({},"& .".concat(Yt.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)})})),Xt=function e(t){var n=t.history,a=(0,qe.A)(),o=(0,l.Jy)(),c=o.data,s=o.isLoading,f=o.error,E=zt((0,r.useState)(null),2),P=E[0],w=E[1];(0,r.useEffect)((function(){f&&w(f.message)}),[f]);var S=zt((0,r.useState)(),2),C=S[0],I=S[1],x=zt((0,r.useState)(!1),2),O=x[0],j=x[1],T=zt((0,r.useState)(!1),2),D=T[0],M=T[1],L=zt((0,r.useState)(!1),2),k=L[0],W=L[1],R=zt((0,r.useState)(!1),2),V=R[0],N=R[1],F=zt((0,r.useState)([]),2),B=F[0],G=F[1],_=(0,i.g)().apiType;_&&(_=_.toUpperCase());var U="WEBSUB"===_;(0,r.useEffect)((function(){h.A.asyncAPIPolicies().then((function(e){var t=e.body.list;0===t.length?A.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.policies.not.available",defaultMessage:[{type:0,value:"Throttling policies not available. Contact your administrator"}]})):U&&t.filter((function(e){return"AsyncWHUnlimited"===e.policyName})).length>0?G(["AsyncWHUnlimited"]):!U&&t.filter((function(e){return"AsyncUnlimited"===e.policyName})).length>0?G(["AsyncUnlimited"]):G([t[0].policyName])}))}),[]);var q={WebSocket:"WS",SSE:"SSE",WebSub:"WEBSUB"},Q=zt((0,r.useState)(!_||_===q.WebSub),2),$=Q[0],z=Q[1],K=zt((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"name":case"version":case"context":case"endpoint":case"policies":case"isFormValid":return $t($t({},e),{},Jt({},n,r));case"protocol":return z(q[r]===q.WebSub),$t($t({},e),{},Jt({},n,q[r]));default:return e}}),{formValidity:!1}),2),J=K[0],Y=K[1],H=J.name&&J.context&&J.version&&!C;function X(e){var t=e.target,n=t.name,r=t.value;Y({action:n,value:r})}function Z(){I(!0);var e=J.name,t=J.version,n=J.context,r=J.endpoint,a=J.protocol,i={name:e,version:t,context:n,endpoint:r,type:_||a.toUpperCase(),policies:B},o="http";return(_&&"WS"===_.toUpperCase()||a&&"WS"===a.toUpperCase())&&(o="ws"),r&&(i.endpointConfig={endpoint_type:o,sandbox_endpoints:{url:r},production_endpoints:{url:r}}),new h.A(i).saveStreamingAPI().then((function(e){return A.A.info("API created successfully"),e})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API"),console.error(e),j(!1)})).finally((function(){I(!1)})).finally((function(){return I(!1)}))}var te=r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.api.heading",defaultMessage:[{type:0,value:"Create a Streaming API"}]})),r.createElement(u.A,{variant:"caption"},U?r.createElement(m.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.websub.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version and a Context"}]}):r.createElement(m.A,{id:"Apis.Create.StreamingAPI.APICreateStreamingAPI.api.sub.heading",defaultMessage:[{type:0,value:"Create an API by providing a Name, a Version, a Context and the Endpoint"}]})));return r.createElement(Ht,{title:te},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"center",alignItems:"center"},P&&r.createElement(p.Ay,{item:!0,xs:11},r.createElement(b.A,{onClose:function(){return w(null)},disableActions:!0,dense:!0,paperProps:{elevation:1},type:"error",message:P})),r.createElement(p.Ay,{item:!0,xs:12},s&&r.createElement(d.A,{mt:-2},r.createElement(g.A,{"data-testid":"loading-publisher-settings"}))),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(xe,{onValidate:function(e){Y({action:"isFormValid",value:e})},onChange:X,api:J,endpointPlaceholderText:"Streaming Provider",appendChildrenBeforeEndpoint:!0,hideEndpoint:$,isWebSocket:_&&_===q.WebSocket||J.protocol===q.WebSocket},r.createElement(ee.A,{fullWidth:!0,select:!0,label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.streaming.Components.SelectPolicies.business.plans",defaultMessage:[{type:0,value:"Protocol"}]}),r.createElement("sup",{className:Yt.mandatoryStar},"*")),value:_?{WS:"WebSocket",SSE:"SSE",WEBSUB:"WebSub"}[_]:J.protocol,disabled:_,name:"protocol",SelectProps:{multiple:!1,renderValue:function(e){return e}},margin:"normal",variant:"outlined",InputProps:{id:"itest-id-apipolicies-input"},onChange:X},[{displayName:"WebSocket",description:"WebSocket API"},{displayName:"WebSub",description:"WebHook API based on WebSub specification"},{displayName:"SSE",description:"Server-Sent Events"}].map((function(e){return r.createElement(_t.A,{dense:!0,disableGutters:!1,value:e.displayName},r.createElement(Ut.A,{primary:e.displayName,secondary:e.description}))}))))),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},r.createElement(y.A,{variant:"contained",color:"primary",disabled:!(H&&J.isFormValid),onClick:function(){Z().then((function(e){n.push("/apis/".concat(e.id,"/overview"))}))},"data-testid":"itest-create-streaming-api-button"},"Create"," ",C&&!V&&r.createElement(g.A,{size:24}))),!de.A.isNotPublisher()&&r.createElement(p.Ay,{item:!0},r.createElement(y.A,{id:"itest-id-apicreatedefault-createnpublish",variant:"contained",color:"primary",disabled:k||D||!H||!J.isFormValid,onClick:function(){var t=new h.A;N(!0),Z().then((function(r){M(!0),t.createRevision(r.id,{description:"Initial Revision"}).then((function(i){var o=i.body.id;A.A.info("API Revision created successfully"),M(!1);var l=c.environment.map((function(e){return e.name})),s=[],u=function(e){var t=c.environment.find((function(t){return t.name===e&&t.vhosts.length>0}));return t&&t.vhosts[0].host};if(c.gatewayTypes&&1===c.gatewayTypes.length)l&&l.length>0&&(l.includes("Default")&&u("Default")?s.push({name:"Default",displayOnDevportal:!0,vhost:u("Default")}):u(l[0])&&s.push({name:l[0],displayOnDevportal:!0,vhost:u(l[0])}));else{var p=c.environment,d=!1;p.forEach((function(e){!d&&"Regular"===e.gatewayType&&u(e.name)&&(s.push({name:e.name,displayOnDevportal:!0,vhost:u(e.name)}),d=!0)}))}W(!0),t.deployRevision(r.id,o,s).then((function(){A.A.info("API Revision Deployed Successfully"),W(!1),j(!0),r.publish().then((function(t){t.body.workflowStatus===e.WORKFLOW_STATUS.CREATED?A.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.publishStatus",defaultMessage:[{type:0,value:"Lifecycle state change request has been sent"}]})):A.A.info(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.success.otherStatus",defaultMessage:[{type:0,value:"API updated successfully"}]})),n.push("/apis/".concat(r.id,"/overview"))})).catch((function(e){e.response?(A.A.error(e.response.body.description),w(e.response.body)):(A.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.publish",defaultMessage:[{type:0,value:"Something went wrong while publishing the API"}]})),w("Something went wrong while publishing the API")),console.error(e)})).finally((function(){j(!1),N(!1)}))})).catch((function(e){e.response?(A.A.error(e.response.body.description),w(e.response.body)):(A.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.deploy.revision",defaultMessage:[{type:0,value:"Something went wrong while deploying the API Revision"}]})),w("Something went wrong while deploying the API Revision")),console.error(e)})).finally((function(){W(!1)}))})).catch((function(e){e.response?(A.A.error(e.response.body.description),w(e.response.body)):(A.A.error(a.formatMessage({id:"Apis.Create.Default.APICreateDefault.error.errorMessage.create.revision",defaultMessage:[{type:0,value:"Something went wrong while creating the API Revision"}]})),w("Something went wrong while creating the API Revision")),console.error(e)})).finally((function(){M(!1)}))}))}},!O&&!D&&!k&&"Create & Publish",(O||D||k)&&r.createElement(g.A,{size:24}),C&&O&&"Creating API . . .",!C&&D&&!k&&"Creating Revision . . .",!C&&O&&!D&&!k&&"Publishing API . . .",!C&&O&&!D&&k&&"Deploying Revision . . .")),r.createElement(p.Ay,{item:!0},r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,{variant:"text"},r.createElement(m.A,{id:"Apis.Create.Default.APICreateDefault.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))))))))};Xt.WORKFLOW_STATUS={CREATED:"CREATED"};const Zt=(0,i.y)(Xt);var en=n(87070),tn=n.n(en),nn=n(57555),rn=n(4531);const an=function(e){var t=e.classes,n=e.apiInputs,a=e.inputsDispatcher,i=e.isValidExternalEndpoint,o=e.setValidExternalEndpoint,l=e.validateEndpoint;return r.createElement(r.Fragment,null,r.createElement(ee.A,{fullWidth:!0,id:"itest-id-api-external-endpoint-input",label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.externalEndpoint",defaultMessage:[{type:0,value:"External Endpoint"}]}),r.createElement("sup",{className:t.mandatoryStar},"*")),name:"externalEndpoint",value:n.externalEndpoint,onChange:function(e){var t=e.target,n=t.name,r=t.value;o(l(r)),a({action:n,value:r})},helperText:!i&&r.createElement("div",{style:{marginTop:"10px"}},r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.externalEndpoint.error",defaultMessage:[{type:0,value:"Invalid Endpoint URL"}]})),error:!i,margin:"normal",variant:"outlined"}),r.createElement(rn.A,{severity:"warning",className:t.externalEndpointWarning},r.createElement(u.A,{gutterBottom:!0,component:"div",className:t.alertTitle},r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.advertiseOnly.warning.title",defaultMessage:[{type:0,value:'"Other" type streaming APIs will be created as third party APIs.'}]})),r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.advertiseOnly.warning",defaultMessage:[{type:0,value:"API Manager only supports the streaming APIs of types WebSocket, SSE and WebSub. Please create one of the supported types if you want to deploy it in the gateway."}]})))};var on=n(84999);function ln(e){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ln(e)}function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function un(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dn(e,t,n){var r;return r=function(e,t){if("object"!=ln(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=ln(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t),(t="symbol"==ln(r)?r:String(r))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var mn="ApiCreateAsyncAPI",fn={mandatoryStar:"".concat(mn,"-mandatoryStar"),externalEndpointWarning:"".concat(mn,"-externalEndpointWarning"),alertTitle:"".concat(mn,"-alertTitle")},yn=(0,a.Ay)(Z)((function(e){var t=e.theme;return dn(dn(dn({},"& .".concat(fn.mandatoryStar),{color:t.palette.error.main,marginLeft:t.spacing(.1)}),"& .".concat(fn.externalEndpointWarning),{marginTop:t.spacing(2),marginBottom:t.spacing(2)}),"& .".concat(fn.alertTitle),{fontWeight:t.typography.fontWeightMedium,marginTop:-2})}));function vn(e){var t=un((0,r.useState)(0),2),n=t[0],a=t[1],i=e.history,o=un((0,r.useState)(!0),2),l=o[0],c=o[1],s=un((0,r.useState)(!0),2),f=s[0],b=s[1],E=un((0,r.useState)(!0),2),P=E[0],w=E[1],S=un((0,r.useReducer)((function(e,t){var n=t.action,r=t.value;switch(n){case"type":case"inputValue":case"name":case"version":case"endpoint":case"gatewayVendor":case"asyncTransportProtocols":case"protocol":case"context":case"policies":case"isFormValid":case"externalEndpoint":return sn(sn({},e),{},dn({},n,r));case"inputType":return sn(sn({},e),{},dn(dn({},n,r),"inputValue","url"===r?"":null));case"preSetAPI":return sn(sn({},e),{},{name:r.name.replace(/[&/\\#,+()$~%.'":*?<>{}\s]/g,""),version:r.version,context:r.context,endpoint:r.endpoints&&r.endpoints[0],gatewayVendor:r.gatewayVendor,asyncTransportProtocols:r.asyncTransportProtocols});default:return e}}),{type:"ApiCreateAsyncAPI",inputType:"url",inputValue:"",formValidity:!1}),2),C=S[0],I=S[1],x={WebSocket:"WS",SSE:"SSE",WebSub:"WEBSUB",Other:"ASYNC"};function O(e){return!!e&&!tn().string().uri().empty().validate(e).error}function j(e){I({action:"isFormValid",value:e})}var T=un((0,r.useState)(),2),D=T[0],M=T[1];return r.createElement(yn,{title:r.createElement(r.Fragment,null,r.createElement(u.A,{variant:"h5"},r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.heading",defaultMessage:[{type:0,value:"Create an API using an AsyncAPI definition."}]})),r.createElement(u.A,{variant:"caption"},r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.sub.heading",defaultMessage:[{type:0,value:"Create an API using an existing AsyncAPI definition file or URL."}]})))},r.createElement(d.A,{sx:{mb:2}},r.createElement(Qe.A,{alternativeLabel:!0,activeStep:0},r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.wizard.one",defaultMessage:[{type:0,value:"Provide AsyncAPI"}]}))),r.createElement($e.A,null,r.createElement(ze.A,null,r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.wizard.two",defaultMessage:[{type:0,value:"Create API"}]}))))),r.createElement(p.Ay,{container:!0,spacing:2},r.createElement(p.Ay,{item:!0,xs:12},0===n&&r.createElement(on.A,{onValidate:j,apiInputs:C,inputsDispatcher:I}),1===n&&r.createElement(xe,{onValidate:j,onChange:function(e){var t=e.target,n=t.name,r=t.value;I({action:n,value:r})},api:C,isAPIProduct:!1,hideEndpoint:l,endpointPlaceholderText:"Streaming Provider",appendChildrenBeforeEndpoint:!0},r.createElement(p.Ay,{container:!0,spacing:2},"solace"===C.gatewayVendor&&0!==C.asyncTransportProtocols.length&&r.createElement(r.Fragment,null,r.createElement(p.Ay,{item:!0,xs:12,md:6,lg:3},r.createElement(u.A,{component:"p",variant:"subtitle2"},r.createElement(m.A,{id:"Apis.Details.NewOverview.MetaData.solace.transports",defaultMessage:[{type:0,value:"Available Protocols"}]}))),r.createElement(p.Ay,{item:!0,xs:12,md:6,lg:9},C.asyncTransportProtocols.map((function(e){return r.createElement(ae.A,{"data-testid":(0,nn.mf)(e)+"-label",key:e,label:(0,nn.mf)(e),style:{"font-size":13,height:20,marginRight:5},color:"primary"})}))))),"wso2"===C.gatewayVendor&&r.createElement(ee.A,{fullWidth:!0,select:!0,label:r.createElement(r.Fragment,null,r.createElement(m.A,{id:"Apis.Create.asyncAPI.Components.SelectPolicies.business.plans",defaultMessage:[{type:0,value:"Protocol"}]}),r.createElement("sup",{className:fn.mandatoryStar},"*")),value:C.protocol,name:"protocol",SelectProps:{multiple:!1,renderValue:function(e){return e}},margin:"normal",variant:"outlined",InputProps:{id:"itest-id-apipolicies-input"},onChange:function(e){var t=e.target,n=t.name,r=t.value;"WebSub"===r?(c(!0),b(!0),w(!0)):"Other"===r?(c(!0),b(!1),w(O(C.externalEndpoint))):(c(!1),b(!0),w(!0)),I({action:n,value:r})}},[{name:"ws",displayName:"WebSocket",description:"WebSocket API"},{name:"websub",displayName:"WebSub",description:"WebHook API based on WebSub specification"},{name:"sse",displayName:"SSE",description:"Server-Sent Events"},{name:"other",displayName:"Other",description:"Other Async APIs such as AMQP, MQTT etc."}].map((function(e){return r.createElement(_t.A,{dense:!0,disableGutters:!1,id:e.name,key:e.name,value:e.displayName},r.createElement(Ut.A,{primary:e.displayName,secondary:e.description}))}))),!f&&r.createElement(an,{classes:fn,apiInputs:C,inputsDispatcher:I,isValidExternalEndpoint:P,setValidExternalEndpoint:w,validateEndpoint:O}))),r.createElement(p.Ay,{item:!0,xs:12},r.createElement(p.Ay,{container:!0,direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2},r.createElement(p.Ay,{item:!0},0===n&&r.createElement(v.N_,{to:"/apis/"},r.createElement(y.A,null,r.createElement(m.A,{id:"Apis.Create.AsyncAPI.ApiCreateAsyncAPI.cancel",defaultMessage:[{type:0,value:"Cancel"}]}))),1===n&&r.createElement(y.A,{onClick:function(){return a((function(e){return e-1}))}},"Back")),r.createElement(p.Ay,{item:!0},0===n&&r.createElement(y.A,{"data-testid":"next-btn",onClick:function(){return a((function(e){return e+1}))},variant:"contained",color:"primary",disabled:!C.isFormValid},"Next"),1===n&&r.createElement(y.A,{"data-testid":"asyncapi-create-btn",variant:"contained",color:"primary",disabled:!C.isFormValid||D||!P,onClick:function(){M(!0);var e=C.name,t=C.version,n=C.context,r=C.endpoint,a=C.policies,o=C.inputValue,l=C.inputType,c=C.protocol,s=C.gatewayVendor,u=C.externalEndpoint,p={name:e,version:t,context:n,policies:a,type:x[c],gatewayVendor:s};"solace"===s&&(p.type=x.WebSub),r&&(p.endpointConfig={endpoint_type:"http",sandbox_endpoints:{url:r},production_endpoints:{url:r}}),"ASYNC"===x[c]&&(p.advertiseInfo={advertised:!0,apiExternalProductionEndpoint:u,apiExternalSandboxEndpoint:u,originalDevPortalUrl:"",apiOwner:"admin",vendor:"WSO2"});var d=new h.A(p);("file"===l?d.importAsyncAPIByFile(o):d.importAsyncAPIByUrl(o)).then((function(e){A.A.info("API created successfully"),i.push("/apis/".concat(e.id,"/overview"))})).catch((function(e){e.response?A.A.error(e.response.body.description):A.A.error("Something went wrong while adding the API"),console.error(e)})).finally((function(){return M(!1)}))}},"Create"," ",D&&r.createElement(g.A,{size:24})))))))}function An(e){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},An(e)}function gn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hn(){return hn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hn.apply(this,arguments)}vn.propTypes={history:s().shape({push:s().func}).isRequired};var bn,En,Pn,wn,Sn={content:"".concat("APICreateRoutes","-content")},Cn=(0,a.Ay)("div")((bn={},Pn={flexGrow:1},wn=function(e,t){if("object"!=An(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=An(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(En="&.".concat(Sn.content)),(En="symbol"==An(wn)?wn:String(wn))in bn?Object.defineProperty(bn,En,{value:Pn,enumerable:!0,configurable:!0,writable:!0}):bn[En]=Pn,bn)),In=function(e,t){return function(n){return r.createElement(e,hn({},n,t))}};const xn=function(){var e=(0,l.Jy)().data,t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(!1),2),n=t[0],a=t[1];return(0,r.useEffect)((function(){null!=e&&(e.gatewayTypes&&2===e.gatewayTypes.length?a(!0):a(!1))}),[e]),r.createElement(Cn,{className:Sn.content},r.createElement(i.dO,null,r.createElement(i.qh,{path:"/apis/create/rest",component:In(Ue,{multiGateway:n})}),r.createElement(i.qh,{path:"/api-products/create",component:it}),r.createElement(i.qh,{path:"/apis/create/graphQL",component:In(Bt,{multiGateway:n})}),r.createElement(i.qh,{path:"/apis/create/openapi",component:In(ft,{multiGateway:n})}),r.createElement(i.qh,{path:"/apis/create/wsdl",component:Mt}),r.createElement(i.qh,{path:"/apis/create/ws",component:Gt}),r.createElement(i.qh,{path:"/apis/create/streamingapi/:apiType",component:Zt}),r.createElement(i.qh,{path:"/apis/create/asyncapi",component:vn}),r.createElement(i.qh,{component:o.A})))}}}]);
//# sourceMappingURL=APICreateRoutes.2ae3aa2df0c5dedb4461.bundle.js.map